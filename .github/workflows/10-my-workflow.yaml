name: My Workflow

on:
    workflow_dispatch:
        # push:
        #     branches:
        #         - 'example-branch/*'
env:
    WORKFLOW_VAR: I_AM_WORKFLOW_SCOPED

jobs:
    say_my_word:
        runs-on: ubuntu-24.04
        steps:
            - run: echo "Go to Surfing"

    say-surf-in-python:
        runs-on: ubuntu-24.04
        steps:
            - run: print("Hello Surfing")
              shell: python

    say-surf-in-pwsh:
        runs-on: windows-latest
        outputs:
            volume: ${{ steps.generate-volume.outputs.volume }}

        env:
            JOB_VAR: I_AM_JOB_1_SCOPED
        needs:
            - say-surf-in-python
            - say_my_word
            - say-surf-is-js
        steps:
            - run: Write-Host 'say-surf-in-pwsh no shat'
            - name: echo var
              env:
                  STEP_VAR: STEP VAR IN ECHO VAR
              run: |
                  $STEP_VAR
                  $WORKFLOW_VAR
                  $JOB_VAR
            - run: |
                  echo "WORKFLOW_VAR: $WORKFLOW_VAR"   # visible
                  echo "JOB_VAR:      $JOB_VAR"        # visible
                  echo "STEP_VAR:     $STEP_VAR"       # visible only here
            - name: set var
              id: generate-volume
              run: |
                  $volume_value = (Get-Process | Select-Object -First 1).Id

                  # 2. ‚ùó ÈóúÈçµ‰øÆÊ≠£ÔºöÂ∞á 'key=value' Ê†ºÂºèÁöÑÂ≠ó‰∏≤ÂØ´ÂÖ• $GITHUB_OUTPUT
                  $output_line = "volume=$volume_value"

                  # 3. ‰ΩøÁî® Out-File Â∞áÊ†ºÂºèÊ≠£Á¢∫ÁöÑÂ≠ó‰∏≤ÂØ´ÂÖ• $GITHUB_OUTPUT Ê™îÊ°à
                  $output_line | Out-File -FilePath $env:GITHUB_OUTPUT -Encoding UTF8 -Append

                  Write-Host "ÊàêÂäüÂØ´ÂÖ• $env:GITHUB_OUTPUT: $output_line"
    say-surf-is-js:
        runs-on: ubuntu-24.04
        steps:
            - uses: actions/hello-world-javascript-action@081a6d193d1dcb38460df1e6927486d748730f9d # v1.1
              # - uses: actions/hello-world-javascript-action@v1 # This would work, but it would be less stable and less secure:
              with:
                  who-to-greet: 'from an action in the GitHub Action marketplace! üëã'

    print-var-in-pwsh:
        runs-on: windows-latest
        needs:
            - say-surf-in-pwsh
        steps:
            - name: Print PWSH $Vars
              run: |
                  $GITHUB_ENV
                  $GITHUB_OUTPUT

            - name: Print Variables
              run: |
                  $output = "${{ needs.say-surf-in-pwsh.outputs.volume }}"
                  Write-Host "Âæû‰∏ä‰∏ÄÂÄã Job ËÆÄÂèñÂà∞ÁöÑ Volume ËÆäÊï∏: $output"
    staging-environment:
        runs-on: ubuntu-24.04
        environment: staging
        env:
            # Inject repository-level secret & variable into the shell
            EXAMPLE_REPOSITORY_SECRET: ${{ secrets.EXAMPLE_REPOSITORY_SECRET }}
            EXAMPLE_REPOSITORY_VARIABLE: ${{ vars.EXAMPLE_REPOSITORY_VARIABLE }}
            # Inject environment-level items into the shell
            EXAMPLE_ENVIRONMENT_SECRET: ${{ secrets.EXAMPLE_ENVIRONMENT_SECRET }}
            EXAMPLE_ENVIRONMENT_VARIABLE: ${{ vars.EXAMPLE_ENVIRONMENT_VARIABLE }}
        steps:
            - name: Inspect values inside job
              run: |
                  echo "Repo secret (masked): $EXAMPLE_REPOSITORY_SECRET"
                  echo "Repo variable: $EXAMPLE_REPOSITORY_VARIABLE"
                  echo "Env secret (masked): $EXAMPLE_ENVIRONMENT_SECRET"
                  echo "Env variable: $EXAMPLE_ENVIRONMENT_VARIABLE"

    production-environment:
        runs-on: ubuntu-24.04
        environment: production
        env:
            # Inject repository-level secret & variable into the shell
            EXAMPLE_REPOSITORY_SECRET: ${{ secrets.EXAMPLE_REPOSITORY_SECRET }}
            EXAMPLE_REPOSITORY_VARIABLE: ${{ vars.EXAMPLE_REPOSITORY_VARIABLE }}
            # Inject environment-level items into the shell
            EXAMPLE_ENVIRONMENT_SECRET: ${{ secrets.EXAMPLE_ENVIRONMENT_SECRET }}
            EXAMPLE_ENVIRONMENT_VARIABLE: ${{ vars.EXAMPLE_ENVIRONMENT_VARIABLE }}
        steps:
            - name: Inspect values inside job
              run: |
                  echo "Repo secret (masked):    $EXAMPLE_REPOSITORY_SECRET"
                  echo "Repo variable:           $EXAMPLE_REPOSITORY_VARIABLE"
                  echo "Env secret (masked):     $EXAMPLE_ENVIRONMENT_SECRET"
                  echo "Env variable:            $EXAMPLE_ENVIRONMENT_VARIABLE"
